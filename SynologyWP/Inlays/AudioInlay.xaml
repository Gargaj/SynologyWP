<UserControl
    x:Class="SynologyWP.Inlays.AudioInlay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SynologyWP.Inlays"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:c="using:Microsoft.Xaml.Interactions.Core" 
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition Height="96"/>
    </Grid.RowDefinitions>
    <Grid.Resources>
      <CollectionViewSource x:Name="groupedArtists" IsSourceGrouped="True"/>
      <CollectionViewSource x:Name="groupedAlbums" IsSourceGrouped="True"/>
    </Grid.Resources>

    <Pivot Grid.Row="0" x:Name="MainPivot" PivotItemLoading="Pivot_PivotItemLoading">
      <Pivot.Resources>
        <Style TargetType="PivotItem">
          <Setter Property="Margin" Value="0"/>
        </Style>
        <Style TargetType="PivotHeaderItem">
          <Setter Property="Margin" Value="0"/>
          <Setter Property="Padding" Value="0,0,12,0"/>
          <Setter Property="FontSize" Value="16"/>
        </Style>
      </Pivot.Resources>
      
      <!-- Artists -->
      <PivotItem x:Name="Artists">
        <PivotItem.Header>
          <TextBlock Text="Artists"/>
        </PivotItem.Header>

        <SemanticZoom IsZoomOutButtonEnabled="True" ScrollViewer.ZoomMode="Enabled">
          <SemanticZoom.ZoomedOutView>
            <GridView x:Name="ArtistsKeys" SelectionMode="None" HorizontalAlignment="Center" Padding="0">
              <GridView.ItemTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding Group.Key}" Width="42" FontSize="40" Margin="15" Foreground="{ThemeResource SystemControlHighlightAccentBrush}" TextAlignment="Center"/>
                </DataTemplate>
              </GridView.ItemTemplate>
              <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                  <VariableSizedWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="5"/>
                </ItemsPanelTemplate>
              </GridView.ItemsPanel>
            </GridView>
          </SemanticZoom.ZoomedOutView>
          <SemanticZoom.ZoomedInView>
            <GridView ItemsSource="{Binding Source={StaticResource groupedArtists}}" HorizontalAlignment="Center">

              <GridView.ItemTemplate>
                <DataTemplate>
                  <StackPanel Orientation="Vertical" Margin="5,5" Tapped="Artist_Tapped">
                    <Image Width="80" Height="80" Stretch="UniformToFill">
                      <Image.Source>
                        <BitmapImage UriSource="{Binding CoverImageURL}"/>
                      </Image.Source>
                    </Image>
                    <TextBlock Text="{Binding Name}" TextAlignment="Center" Width="80" Height="48" FontSize="12" TextWrapping="WrapWholeWords"/>
                  </StackPanel>
                </DataTemplate>
              </GridView.ItemTemplate>

              <GridView.GroupStyle>
                <GroupStyle HidesIfEmpty="True">
                  <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                      <Grid Margin="0">
                        <TextBlock Text="{Binding Key}" Foreground="{ThemeResource SystemControlHighlightAccentBrush}"/>
                      </Grid>
                    </DataTemplate>
                  </GroupStyle.HeaderTemplate>
                </GroupStyle>
              </GridView.GroupStyle>

            </GridView>
          </SemanticZoom.ZoomedInView>
        </SemanticZoom>

      </PivotItem>

      <!-- Albums -->
      <PivotItem x:Name="Albums">
        <PivotItem.Header>
          <TextBlock Text="Albums"/>
        </PivotItem.Header>

        <SemanticZoom IsZoomOutButtonEnabled="True" ScrollViewer.ZoomMode="Enabled">
          <SemanticZoom.ZoomedOutView>
            <GridView x:Name="AlbumKeys" SelectionMode="None" HorizontalAlignment="Center" Padding="0">
              <GridView.ItemTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding Group.Key}" Width="42" FontSize="40" Margin="15" Foreground="{ThemeResource SystemControlHighlightAccentBrush}" TextAlignment="Center"/>
                </DataTemplate>
              </GridView.ItemTemplate>
              <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                  <VariableSizedWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="5"/>
                </ItemsPanelTemplate>
              </GridView.ItemsPanel>
            </GridView>
          </SemanticZoom.ZoomedOutView>
          <SemanticZoom.ZoomedInView>
            <GridView ItemsSource="{Binding Source={StaticResource groupedAlbums}}" HorizontalAlignment="Center">

              <GridView.ItemTemplate>
                <DataTemplate>
                  <StackPanel Orientation="Vertical" Margin="5,5" Tapped="Album_Tapped">
                    <Image Width="80" Height="80" Stretch="UniformToFill">
                      <Image.Source>
                        <BitmapImage UriSource="{Binding CoverImageURL}"/>
                      </Image.Source>
                    </Image>
                    <TextBlock Text="{Binding Name}" TextAlignment="Center" Width="80" Height="48" FontSize="12" TextWrapping="WrapWholeWords"/>
                  </StackPanel>
                </DataTemplate>
              </GridView.ItemTemplate>

              <GridView.GroupStyle>
                <GroupStyle HidesIfEmpty="True">
                  <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                      <Grid Margin="0">
                        <TextBlock Text="{Binding Key}" Foreground="{ThemeResource SystemControlHighlightAccentBrush}"/>
                      </Grid>
                    </DataTemplate>
                  </GroupStyle.HeaderTemplate>
                </GroupStyle>
              </GridView.GroupStyle>

            </GridView>
          </SemanticZoom.ZoomedInView>
        </SemanticZoom>

      </PivotItem>

      <!-- Recently Added -->
      <PivotItem x:Name="Recent">
        <PivotItem.Header>
          <TextBlock Text="Recently Added"/>
        </PivotItem.Header>

        <GridView ItemsSource="{Binding RecentlyAdded}" HorizontalAlignment="Center">

          <GridView.ItemTemplate>
            <DataTemplate>
              <StackPanel Orientation="Vertical" Margin="5,5" Tapped="Album_Tapped">
                <Image Width="80" Height="80" Stretch="UniformToFill">
                  <Image.Source>
                    <BitmapImage UriSource="{Binding CoverImageURL}"/>
                  </Image.Source>
                </Image>
                <TextBlock Text="{Binding Name}" TextAlignment="Center" Width="80" Height="48" FontSize="12" TextWrapping="WrapWholeWords"/>
              </StackPanel>
            </DataTemplate>
          </GridView.ItemTemplate>

          <GridView.ItemsPanel>
            <ItemsPanelTemplate>
              <VariableSizedWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="5"/>
            </ItemsPanelTemplate>
          </GridView.ItemsPanel>
          
        </GridView>

      </PivotItem>

      <!-- Custom inlay for viewing followed profiles -->
      <PivotItem x:Name="ArtistView">
        <PivotItem.Header>
          <TextBlock Text="" Width="0" Margin="0" IsHitTestVisible="False"/>
        </PivotItem.Header>

        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <TextBlock Grid.Row="0" Text="{Binding SelectedArtist.Name}" TextAlignment="Center" FontSize="20" Margin="20" TextWrapping="WrapWholeWords"/>

          <ListView Grid.Row="1" ItemsSource="{Binding SelectedArtistAlbums}">
            <ListView.Resources>
              <Style TargetType="ListViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
              </Style>
            </ListView.Resources>
            <ListView.ItemTemplate>
              <DataTemplate>
                <Grid Tapped="Album_Tapped" Padding="10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="74"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Image Width="64" Height="64" Stretch="UniformToFill" Margin="0,0,10,0">
                    <Image.Source>
                      <BitmapImage UriSource="{Binding CoverImageURL}"/>
                    </Image.Source>
                  </Image>
                  <StackPanel Grid.Column="1" Orientation="Vertical">
                    <TextBlock Text="{Binding Name}" FontSize="18"/>
                    <TextBlock Text="{Binding Year}" FontSize="12" Foreground="{ThemeResource SystemColorGrayTextBrush}"/>
                  </StackPanel>
                </Grid>
              </DataTemplate>
            </ListView.ItemTemplate>
          </ListView>

        </Grid>

      </PivotItem>

      <!-- Custom inlay for viewing followed profiles -->
      <PivotItem x:Name="AlbumView">
        <PivotItem.Header>
          <TextBlock Text="" Width="0" Margin="0" IsHitTestVisible="False"/>
        </PivotItem.Header>

        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="256"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <StackPanel Grid.Row="0" Orientation="Vertical">
            <Image Width="128" Height="128" Stretch="UniformToFill" Margin="20,20,20,5">
              <Image.Source>
                <BitmapImage UriSource="{Binding SelectedAlbum.CoverImageURL}"/>
              </Image.Source>
            </Image>
            <TextBlock Text="{Binding SelectedAlbum.Name}" TextAlignment="Center" FontSize="20" Margin="20,5,20,5" TextWrapping="WrapWholeWords"/>
            <TextBlock Text="{Binding SelectedAlbum.ArtistName}" TextAlignment="Center" FontSize="16" Margin="20,5,20,20" TextWrapping="WrapWholeWords" Foreground="{ThemeResource SystemColorGrayTextBrush}"/>
          </StackPanel>

          <ListView Grid.Row="1" ItemsSource="{Binding SelectedAlbumSongs}">
            <ListView.Resources>
              <Style TargetType="ListViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
              </Style>
            </ListView.Resources>
            <ListView.ItemTemplate>
              <DataTemplate>
                <Grid Padding="5" HorizontalAlignment="Stretch" Tapped="Song_Tapped">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="48"/>
                  </Grid.ColumnDefinitions>
                  <TextBlock Grid.Column="0" Margin="0,0,20,0" Text="{Binding TrackNumber}" FontSize="24" TextAlignment="Right" />
                  <StackPanel Grid.Column="1" Orientation="Vertical">
                    <TextBlock Text="{Binding Title}" FontSize="18"/>
                    <TextBlock Text="{Binding Artist}" FontSize="12" Foreground="{ThemeResource SystemColorGrayTextBrush}"/>
                  </StackPanel>
                  <TextBlock Grid.Column="2" Text="{Binding LengthStr}" FontSize="18" Foreground="{ThemeResource SystemColorGrayTextBrush}" TextAlignment="Right"/>
                </Grid>
              </DataTemplate>
            </ListView.ItemTemplate>
          </ListView>

        </Grid>
      </PivotItem>

    </Pivot>

    <MediaPlayerElement Grid.Row="1" x:Name="audioPlayer" Loaded="AudioPlayer_Loaded" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AreTransportControlsEnabled="True">
      <MediaPlayerElement.TransportControls>
        <MediaTransportControls IsFullWindowButtonVisible="False" IsSeekBarVisible="True" IsZoomButtonVisible="False" IsNextTrackButtonVisible="True" IsPreviousTrackButtonVisible="True"/>
      </MediaPlayerElement.TransportControls>
    </MediaPlayerElement>
  </Grid>
</UserControl>
